# 加密

## OAuth

OAuth 是一个关于授权（authorization）的开放网络标准

OAuth 增加了一个授权层

1. 用户打开客户端以后，客户端要求用户给予授权
1. 用户同意给予客户端授权
1. 客户端使用上一步获得的授权，向认证服务器申请 token
1. 认证服务器对客户端进行认证以后，确认无误，同意发放 token
1. 客户端使用 token，向资源服务器申请获取资源
1. 资源服务器确认 token 无误，同意向客户端开放资源

### 授权方式

OAuth 2.0定义了四种授权方式。

1. 授权码模式（authorization code）
  1. 用户访问客户端，后者将前者导向认证服务器。
  1. 用户选择是否给予客户端授权。
  1. 假设用户给予授权，认证服务器将用户导向客户端事先指定的"重定向URI"（redirection URI），同时附上一个授权码。
  1. 客户端收到授权码，附上早先的"重定向URI"，向认证服务器申请令牌。这一步是在客户端的后台的服务器上完成的，对用户不可见。
  1. 认证服务器核对了授权码和重定向URI，确认无误后，向客户端发送访问令牌（access token）和更新令牌（refresh token）。
1. 简化模式（implicit）：不通过第三方应用程序的服务器，直接在浏览器中向认证服务器申请令牌，跳过了"授权码"这个步骤
1. 密码模式（resource owner password credentials）：用户向客户端提供自己的用户名和密码。客户端使用这些信息，向"服务商提供商"索要授权
1. 客户端模式（client credentials）：客户端以自己的名义，而不是以用户的名义，向"服务提供商"进行认证

## HTTPS URL 传参安全

HTTPS 对报文加密后再通过 tcp 传输，是安全的。

- Web server 日志中会存储URLs：URL一般会存储在日志中，这意味着任何敏感数据(如密码)都会被明文存储
- 浏览器的历史记录会存储URLs
- URLs 可以通过 HTTP Referrer 头传递：当页面中使用了js、images等资源时，请求头的Referrer属性会一起传递
